var C=Object.defineProperty;var k=(i,e,n)=>e in i?C(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var d=(i,e,n)=>(k(i,typeof e!="symbol"?e+"":e,n),n);import{z as t,r as f,D as F,B as H}from"./index-7106e5dc.js";const E={id:"1",name:"qododqsdqsdqs",file_type:"binary",platform:["windows"],size:46846,created_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",created_by_uuid:"a46eaf57-d663-4baa-84e3-f43b2af00cb2",created_timestamp:"2023-09-20T09:30:55.143982484Z",modified_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",modified_timestamp:"2023-09-20T09:30:55.14398269Z",sha256:"e124293e578c684a161f8d726ae13771d5cdc08f2e278d479b60172fb9832b4c",permission_type:"none",run_attempt_count:0,run_success_count:0,share_with_workflow:!1,workflow_is_disruptive:!1},G={id:"2",name:"qsdqssqdsqd",file_type:"binary",platform:["windows"],size:46846,created_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",created_by_uuid:"a46eaf57-d663-4baa-84e3-f43b2af00cb2",created_timestamp:"2023-09-20T09:23:07.32929316Z",modified_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",modified_timestamp:"2023-09-20T09:23:07.329293366Z",sha256:"e124293e578c684a161f8d726ae13771d5cdc08f2e278d479b60172fb9832b4c",permission_type:"none",run_attempt_count:0,run_success_count:0,share_with_workflow:!1,workflow_is_disruptive:!1},N={id:"3",name:"qsdsd",file_type:"binary",platform:["windows"],size:46846,created_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",created_by_uuid:"a46eaf57-d663-4baa-84e3-f43b2af00cb2",created_timestamp:"2023-09-21T09:28:58.222043877Z",modified_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",modified_timestamp:"2023-09-21T09:28:58.222044046Z",sha256:"e124293e578c684a161f8d726ae13771d5cdc08f2e278d479b60172fb9832b4c",permission_type:"none",run_attempt_count:0,run_success_count:0,share_with_workflow:!1,workflow_is_disruptive:!1},m=[{id:"abc123",name:"Mitre hosts"},{id:"def456",name:"RTR hosts"},{id:"ghi789",name:"Response hosts"}],$=[{name:"groups",buckets:[{label:"abc123",count:42},{label:"def456",count:23}]}],J=[{device_id:"xyz987",hostname:"Odysseus"},{device_id:"mno654",hostname:"Agamemnon"},{device_id:"pqr321",hostname:"Achilles"}],M=[{uuid:"uuid1",cid:"cid",uid:"f.bird@crowdstrike.com",first_name:"Falcon",last_name:"Bird",created_at:"2023-09-12T14:35:46Z"},{uuid:"uuid2",cid:"cid",uid:"p.bird@crowdstrike.com",first_name:"Peregrine",last_name:"Bird",created_at:"2023-09-12T14:35:46Z"},{uuid:"uuid3",cid:"cid",uid:"r.dino@crowdstrike.com",first_name:"Raptor",last_name:"Dino",created_at:"2023-09-12T14:35:46Z"}],B={user_id:"dummy",user_name:"dummy",version:0,id:"1",name:"First Job RR",description:"First Job RR description",notification_emails:null,notifications:["paul.rosset@crowdstrike.com"],draft:!0,tags:null,host_count:J.length,run_count:0,total_recurrences:0,action:{type:"installSoftware",install_file_path:"hello",command_switch:"world",file_name:E.name},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:null,hosts:J.map(i=>i.device_id),offline_queueing:!1},run_now:!1,next_run:"2023-09-02T08:25:17.179Z",last_run:"2023-09-02T08:25:17.179Z",created_at:"2023-09-02T08:25:17.179Z",updated_at:"2023-09-02T08:25:17.179Z",deleted_at:"2023-09-02T08:25:17.179Z"},U={user_id:"dummy",user_name:"dummy",version:0,id:"2",name:"Second Job Test RR",description:"Second Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},Q={user_id:"dummy",user_name:"dummy",version:0,id:"3",name:"Third Job Test RR",description:"Third Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},z={user_id:"dummy",user_name:"dummy",version:0,id:"4",name:"Fourth Job Test RR",description:"Fourth Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},K={user_id:"dummy",user_name:"dummy",version:0,id:"5",name:"Fifth Job Test RR",description:"Fifth Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},W={user_id:"dummy",user_name:"dummy",version:0,id:"6",name:"Sixth Job Test RR",description:"Sixth Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},X={id:"1",job_id:"1",name:"First Job RR",run_date:"2023-08-11 09:35:29",duration:"00:12:21",status:"completed",hosts:["host1"],output_1:"fileUrl",output_2:"logScaleUrl",numHosts:1,receivedFiles:2,endDate:"2023-08-09 13:42:34"},Y={id:"1",job_id:"1",job_name:"CVE-2023-123456",modified_at:"2023-08-11 09:35:29",version:1,modified_by:"g.thegrey@crowdstrike.com",action:"Created JobRTR"};function x(i){return i.type==="api"}function O(i){return x(i)&&i.api==="faasGateway"}function tt(i){return x(i)&&i.api==="devices"}function et(i){return x(i)&&i.api==="userManagement"}function A(i){return x(i)&&i.api==="remoteResponse"}class nt{isMatch(e){return tt(e)&&(e.method==="postAggregatesDevicesGetV1"||e.method==="getEntitiesGroupsV1"||e.method==="postEntitiesDevicesV2"||e.method==="getQueriesDevicesV2")}async responder(e){let n={};if(e.method==="postAggregatesDevicesGetV1")n={errors:[],resources:$};else if(e.method==="getEntitiesGroupsV1")n={errors:[],resources:m};else if(e.method==="getQueriesDevicesV2"){const r=J.map(o=>o.device_id);n={errors:[],resources:r}}else e.method==="postEntitiesDevicesV2"&&(n={errors:[],resources:J});return Promise.resolve(n)}}class it{isMatch(e){return et(e)&&(e.method==="postEntitiesUsersGetV1"||e.method==="getQueriesUsersV1")}async responder(e){let n={};return e.method==="postEntitiesUsersGetV1"?n={errors:[],resources:M}:e.method==="getQueriesUsersV1"&&(n={errors:[],resources:M.map(r=>r.uuid)}),Promise.resolve(n)}}const rt={jobs:[],history:[],logs:[],rtrPutFiles:[]},Mt={jobs:[B,U,Q,z,K,W],history:[X],logs:[Y],rtrPutFiles:[E,G,N]},D=t.object({type:t.literal("installSoftware"),install_file_path:t.string().optional(),command_switch:t.string().optional(),file_name:t.string()}),S=t.object({type:t.literal("removeFile"),remove_file_name:t.string(),remove_file_path:t.string()}),ot=t.object({user_id:t.string(),user_name:t.string(),name:t.string(),description:t.string(),notifications:t.union([t.null(),t.array(t.string())]),tags:t.union([t.null(),t.array(t.string())]),action:t.union([D,S]),run_now:t.boolean(),schedule:t.union([t.object({start_date:t.string()}),t.null()]),target:t.object({host_groups:t.union([t.null(),t.array(t.string())]),hosts:t.union([t.null(),t.array(t.string())]),offline_queueing:t.boolean()})});t.object({user_id:t.string(),user_name:t.string(),version:t.number(),id:t.string(),name:t.string(),description:t.string(),notification_emails:t.union([t.null(),t.array(t.string())]).optional(),notifications:t.union([t.null(),t.array(t.string())]),draft:t.boolean(),tags:t.union([t.null(),t.array(t.string())]),host_count:t.number(),run_count:t.number(),total_recurrences:t.number(),action:t.union([D,S]),schedule:t.union([t.object({start_date:t.string()}),t.null()]),target:t.object({host_groups:t.union([t.null(),t.array(t.string())]),hosts:t.union([t.null(),t.array(t.string())]),offline_queueing:t.boolean()}),run_now:t.boolean(),next_run:t.string(),last_run:t.string(),created_at:t.string(),updated_at:t.string(),deleted_at:t.string()});const st=t.object({method:t.string(),payload:t.object({body:t.object({function_id:t.string().optional(),function_name:t.string().optional(),payload:t.object({path:t.string()})})})}),at=t.object({function_id:t.string().optional(),function_name:t.string().optional(),function_version:t.number(),payload:t.object({params:t.object({query:t.object({draft:t.array(t.union([t.literal("true"),t.literal("false")]))}).optional()}).optional(),body:ot})}),ut=t.object({payload:t.object({body:t.object({payload:t.object({params:t.object({query:t.object({fieldName:t.union([t.literal("name"),t.literal("description"),t.literal("last_run_date"),t.literal("next_run_date"),t.literal("hosts"),t.literal("last_modified"),t.literal("draft")]).optional(),direction:t.union([t.literal("ASC"),t.literal("DESC")]).optional(),limit:t.union([t.array(t.literal("5")),t.array(t.literal("10")),t.array(t.literal("15")),t.array(t.literal("20"))]).optional(),offset:t.array(t.string()).optional(),prev:t.array(t.string()).optional(),next:t.array(t.string()).optional()}).optional()}).optional()})})})}),dt=t.object({payload:t.object({body:t.object({payload:t.object({params:t.object({query:t.object({id:t.array(t.string())})})})})})}),Z=":";class P{constructor({db:e,appName:n}){d(this,"functionId","mock-faas-function");d(this,"functionName","mock-faas-function-name");d(this,"requestPath","/mock-path");d(this,"counter",0);d(this,"bus",{});d(this,"db");d(this,"appName");this.db=e,this.appName=n}isMatch(e){return O(e)&&(this.isPost(e)||this.isGet(e))}isPost(e){const n=st.safeParse(e);if(!n.success)return!1;const{method:r}=n.data,{function_id:o,function_name:s}=n.data.payload.body,{path:a}=n.data.payload.body.payload;return r==="postEntitiesExecutionV1"&&(o===this.functionId||s===this.functionName)&&a===this.requestPath}isGet(e){const{id:n}=e.payload.params;if(typeof n!="string")return!1;const[r,o,s,a]=n.split(Z);return e.method==="getEntitiesExecutionV1"&&(r===this.functionId||o===this.functionName)&&s===this.requestPath}prepareResponse(e){return{errors:[],resources:[]}}async responder(e){if(this.isPost(e)){const n=[this.functionId,this.functionName,this.requestPath,++this.counter].join(Z);return this.bus[n]=this.prepareResponse(e),Promise.resolve({resources:[{execution_id:n,function_id:this.functionId}]})}else if(this.isGet(e)){const{id:n}=e.payload.params;if(!n||typeof n!="string")throw"No id supplied";if(!this.bus[n])throw`No response for id: ${n}`;return Promise.resolve(this.bus[n])}}}class lt extends P{constructor(e){super(e),this.functionId=f.createJob.id,this.functionName=f.createJob.name,this.requestPath=f.createJob.path}prepareResponse(e){var o,s;if(!("body"in e.payload))throw`CreateJobHandler received bad message: ${e.toString()}`;const r=at.safeParse(e.payload.body);if(r.success){const a=this.db.jobs.findIndex(p=>p.name===r.data.payload.body.name);if(a>-1&&this.db.jobs[a].draft===!1)return{resources:[{function_id:this.functionId,function_name:this.functionName,function_version:1,payload:{body:null,errors:[{field:"jobName",message:`Job name "${r.data.payload.body.name}" already exists"`,code:102}],status_code:400}}]};const[c]=((s=(o=r.data.payload.params)==null?void 0:o.query)==null?void 0:s.draft)??["false"],{...u}=r.data.payload.body,y={id:a>-1?this.db.jobs[a].id:(Math.random()+1).toString(36).substring(7),version:0,draft:c==="true",total_recurrences:0,run_count:0,host_count:0,next_run:"2023-12-01T12:00",last_run:"",created_at:"2023-12-01T12:00",updated_at:"2023-12-01T12:00",deleted_at:"",notification_emails:u.notifications,...u};return a===-1?this.db.jobs.unshift(y):a>-1&&this.db.jobs[a].draft===!0&&(this.db.jobs[a]=y),{errors:[],resources:[{function_id:this.functionId,function_name:this.functionName,function_version:1,payload:{body:{resource:"a_random_uid"},errors:[],status_code:200}}]}}else return{resources:[{function_id:this.functionId,function_name:this.functionName,function_version:1,payload:{body:null,errors:r.error.issues.map(a=>({message:a.message})),status_code:400}}]}}}t.object({job_name:t.string(),modified_at:t.string(),version:t.number(),modified_by:t.string(),action:t.string(),id:t.string(),job_id:t.string()});const ct=t.object({payload:t.object({body:t.object({payload:t.object({params:t.object({query:t.object({fieldName:t.union([t.literal("name"),t.literal("date_modified"),t.literal("version"),t.literal("modified_by"),t.literal("action_taken")]).optional(),direction:t.union([t.literal("ASC"),t.literal("DESC")]).optional(),limit:t.union([t.array(t.literal("5")),t.array(t.literal("10")),t.array(t.literal("15")),t.array(t.literal("20"))]).optional(),offset:t.array(t.string()).optional(),prev:t.array(t.string()).optional(),next:t.array(t.string()).optional(),page:t.number().optional(),id:t.array(t.string()).optional(),filter:t.array(t.string()).optional()}).optional()}).optional()})})})}),q=10;function pt(i,e,n){const r=Math.ceil((n+1)/e);return n===-1?{paginatedJobs:i,page:r}:{paginatedJobs:i.slice(n,n+(e+1)),page:r}}function ft(i,e,n,r,o){var p,_,h;let s=i.findIndex(l=>l.id===n);o!==""?s=i.findIndex(l=>l.id===o):r!==""&&(s=i.findIndex(l=>l.id===r));const{paginatedJobs:a,page:c}=pt(i,e,s),u=(p=i[s-e])!=null&&p.id?`${(_=i[s-e])==null?void 0:_.id}:${c-1}`:"",b=i.slice(-1),g=a.length===e+1?`${(h=b[0])==null?void 0:h.id}:${c}`:"";return{currentPage:e?a.slice(0,e):a,prevCursor:u,nextCursor:g}}class _t extends P{constructor(e){super(e),this.functionId=f.getAuditLog.id,this.functionName=f.getAuditLog.name,this.requestPath=f.getAuditLog.path}prepareResponse(e){var R,T,w,j;const{logs:n}=this.db,o=((R=ct.parse(e).payload.body.payload.params)==null?void 0:R.query)??{},{offset:s=null,limit:a=[String(q)],prev:c=null,next:u=null}=o,b=(s==null?void 0:s[0])??"",g=((T=c==null?void 0:c[0].split(":"))==null?void 0:T[0])??"",y=((w=u==null?void 0:u[0].split(":"))==null?void 0:w[0])??"",p=parseInt(a[0])??q;let _=n;if(o&&o.filter&&o.filter.length>0){const[Jt,V]=o.filter[0].split(":");_=n.filter(L=>V.includes(L.job_id))}const{prevCursor:h,nextCursor:l,currentPage:v}=ft(_,p,b,g,y);return{errors:[],resources:[{function_id:this.functionId,function_version:1,payload:{body:{resources:_,meta:{total:n.length,limit:p,offset:((j=v[0])==null?void 0:j.id)||"",count:v.length,prev:h,next:l}}}}]}}}class ht{constructor({db:e}){d(this,"db");this.db=e}isMatch(e){return A(e)&&e.method==="getEntitiesPutFilesV2"}responder(e){return Promise.resolve({errors:void 0,resources:this.prepareResponse(e)})}prepareResponse(e){const{ids:n}=e.payload.params;return!Array.isArray(n)||n.length===0?[]:this.db.rtrPutFiles.filter(r=>n.includes(r.id))}}class bt extends P{constructor(e){super(e),this.functionId=f.getJobDetails.id,this.functionName=f.getJobDetails.name,this.requestPath=f.getJobDetails.path}prepareResponse(e){const{jobs:n}=this.db,o=dt.parse(e).payload.body.payload.params.query??{},s=n.find(a=>o.id.includes(a.id));return{errors:[],resources:[{function_id:this.functionId,function_version:1,payload:{body:{resource:s}}}]}}}function mt(i,e,n){const r=Math.ceil((n+1)/e);return n===-1?{paginatedJobs:i,page:r}:{paginatedJobs:i.slice(n,n+(e+1)),page:r}}function gt(i,e,n,r,o){var p,_,h;let s=i.findIndex(l=>l.id===n);o!==""?s=i.findIndex(l=>l.id===o):r!==""&&(s=i.findIndex(l=>l.id===r));const{paginatedJobs:a,page:c}=mt(i,e,s),u=(p=i[s-e])!=null&&p.id?`${(_=i[s-e])==null?void 0:_.id}:${c-1}`:"",b=i.slice(-1),g=a.length===e+1?`${(h=b[0])==null?void 0:h.id}:${c}`:"";return{currentPage:e?a.slice(0,e):a,prevCursor:u,nextCursor:g}}class yt extends P{constructor(e){super(e),this.functionId=f.getJobs.id,this.functionName=f.getJobs.name,this.requestPath=f.getJobs.path}prepareResponse(e){var R,T,w,j;const{jobs:n}=this.db,o=((R=ut.parse(e).payload.body.payload.params)==null?void 0:R.query)??{},{offset:s=null,limit:a=[String(F)],prev:c=null,next:u=null}=o,b=(s==null?void 0:s[0])??"",g=((T=c==null?void 0:c[0].split(":"))==null?void 0:T[0])??"",y=((w=u==null?void 0:u[0].split(":"))==null?void 0:w[0])??"",p=parseInt(a[0])??F,_=n,{prevCursor:h,nextCursor:l,currentPage:v}=gt(_,p,b,g,y);return{errors:[],resources:[{function_id:this.functionId,function_version:1,payload:{body:{resources:v,meta:{total:n.length,limit:p,offset:((j=v[0])==null?void 0:j.id)||"",count:v.length,prev:h,next:l}}}}]}}}class vt{constructor({db:e}){d(this,"db");this.db=e}isMatch(e){return A(e)&&e.method==="getQueriesPutFilesV1"}responder(e){return Promise.resolve({errors:void 0,resources:this.prepareResponse(e)})}prepareResponse(e){const{filter:n}=e.payload.params;if(n&&typeof n=="string"){const[r,o]=n.split(":"),s=o.replace(/[']/g,"");return this.db.rtrPutFiles.filter(a=>a.name.includes(s)).map(a=>a.id)}return this.db.rtrPutFiles.map(r=>r.id)}}t.object({id:t.string(),job_id:t.string(),name:t.string(),duration:t.string(),output_1:t.string().optional(),output_2:t.string().optional(),hosts:t.array(t.string()),numHosts:t.number(),receivedFiles:t.number(),run_date:t.string(),endDate:t.string(),status:t.string()});const Rt=t.object({payload:t.object({body:t.object({payload:t.object({params:t.object({query:t.object({fieldName:t.union([t.literal("name"),t.literal("run_date"),t.literal("status"),t.literal("duration"),t.literal("hosts"),t.literal("output_1"),t.literal("output_2")]).optional(),direction:t.union([t.literal("ASC"),t.literal("DESC")]).optional(),limit:t.union([t.array(t.literal("5")),t.array(t.literal("10")),t.array(t.literal("15")),t.array(t.literal("20"))]).optional(),offset:t.array(t.string()).optional(),prev:t.array(t.string()).optional(),next:t.array(t.string()).optional(),id:t.array(t.string()).optional(),filter:t.array(t.string()).optional(),exact_name:t.array(t.string()).optional()}).optional()}).optional()})})})}),I=10;function Tt(i,e,n){var o;const r=i.findIndex(s=>s.id===n);return((o=i[r-e])==null?void 0:o.job_id)||""}function wt(i,e,n){const r=i.findIndex(o=>o.id===n);return r===-1?i:i.slice(r,r+(e+1))}function jt(i,e,n){var u;const r=wt(i,e,n),o=Tt(i,e,n),s=i.slice(-1),a=r.length===e+1?(u=s[0])==null?void 0:u.id:"";return{currentPage:e?r.slice(0,e):r,prevCursor:o,nextCursor:a}}class Pt extends P{constructor(e){super(e),this.functionId=f.getRunHistory.id,this.functionName=f.getRunHistory.name,this.requestPath=f.getRunHistory.path}prepareResponse(e){var _;const{history:n}=this.db,o=((_=Rt.parse(e).payload.body.payload.params)==null?void 0:_.query)??{},{offset:s=null,limit:a=[String(I)]}=o,c=(s==null?void 0:s[0])??"",u=parseInt(a[0])??I;let b=n;if(o&&o.filter&&o.filter.length>0){const h=o.filter[0].split(":")[0],l=o.filter[0].split(":")[1];b=n.filter(v=>{var R,T;if(h==="job_name"&&(((R=o.exact_name)==null?void 0:R.length)??0>0))return((T=o.exact_name)==null?void 0:T[0])==="true"?l===v.name:l.includes(v.name);if(h==="job_id")return v.job_id===l})}const{prevCursor:g,nextCursor:y,currentPage:p}=jt(b,u,c);return{errors:[],resources:[{function_id:this.functionId,function_version:1,payload:{body:{resources:p,meta:{total:n.length,limit:u,count:p.length,prev:g,next:y}}}}]}}}class Zt extends H{constructor({db:n,appName:r}={db:rt,appName:"rapid-response"}){super();d(this,"createJob");d(this,"getJobs");d(this,"getJobDetails");d(this,"getAuditLog");d(this,"getRunHistory");d(this,"getQueriesPutFilesV1");d(this,"getEntitiesPutFilesV2");d(this,"devices");d(this,"userManagement");d(this,"db");this.db=n,this.createJob=new lt({db:this.db,appName:r}),this.getJobs=new yt({db:this.db,appName:r}),this.getJobDetails=new bt({db:this.db,appName:r}),this.getAuditLog=new _t({db:this.db,appName:r}),this.getRunHistory=new Pt({db:this.db,appName:r}),this.getQueriesPutFilesV1=new vt({db:this.db}),this.getEntitiesPutFilesV2=new ht({db:this.db}),this.devices=new nt,this.userManagement=new it}async postMessage(n){let r;if(this.devices.isMatch(n)?r=await this.devices.responder(n):this.userManagement.isMatch(n)?r=await this.userManagement.responder(n):this.getJobs.isMatch(n)?r=await this.getJobs.responder(n):this.createJob.isMatch(n)?r=await this.createJob.responder(n):this.getJobDetails.isMatch(n)?r=await this.getJobDetails.responder(n):this.getAuditLog.isMatch(n)?r=await this.getAuditLog.responder(n):this.getRunHistory.isMatch(n)?r=await this.getRunHistory.responder(n):this.getQueriesPutFilesV1.isMatch(n)?r=await this.getQueriesPutFilesV1.responder(n):this.getEntitiesPutFilesV2.isMatch(n)?r=await this.getEntitiesPutFilesV2.responder(n):r=await super.postMessage(n),!r)throw new Error("Woops!");return console.log("MockBridge#postMessage: ",{message:n,value:r}),r}}export{Zt as MockBridge,rt as emptyScenario,Mt as populatedScenario};
