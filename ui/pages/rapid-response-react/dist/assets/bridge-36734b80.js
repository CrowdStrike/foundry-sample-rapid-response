var C=Object.defineProperty;var k=(i,t,n)=>t in i?C(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n;var u=(i,t,n)=>(k(i,typeof t!="symbol"?t+"":t,n),n);import{z as e,r as f,D as F,B as H}from"./index-31bf163c.js";const E={id:"1",name:"qododqsdqsdqs",file_type:"binary",platform:["windows"],size:46846,created_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",created_by_uuid:"a46eaf57-d663-4baa-84e3-f43b2af00cb2",created_timestamp:"2023-09-20T09:30:55.143982484Z",modified_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",modified_timestamp:"2023-09-20T09:30:55.14398269Z",sha256:"e124293e578c684a161f8d726ae13771d5cdc08f2e278d479b60172fb9832b4c",permission_type:"none",run_attempt_count:0,run_success_count:0,share_with_workflow:!1,workflow_is_disruptive:!1},G={id:"2",name:"qsdqssqdsqd",file_type:"binary",platform:["windows"],size:46846,created_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",created_by_uuid:"a46eaf57-d663-4baa-84e3-f43b2af00cb2",created_timestamp:"2023-09-20T09:23:07.32929316Z",modified_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",modified_timestamp:"2023-09-20T09:23:07.329293366Z",sha256:"e124293e578c684a161f8d726ae13771d5cdc08f2e278d479b60172fb9832b4c",permission_type:"none",run_attempt_count:0,run_success_count:0,share_with_workflow:!1,workflow_is_disruptive:!1},N={id:"3",name:"qsdsd",file_type:"binary",platform:["windows"],size:46846,created_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",created_by_uuid:"a46eaf57-d663-4baa-84e3-f43b2af00cb2",created_timestamp:"2023-09-21T09:28:58.222043877Z",modified_by:"api-client-a46eaf57d6634baa84e3f43b2af00cb2",modified_timestamp:"2023-09-21T09:28:58.222044046Z",sha256:"e124293e578c684a161f8d726ae13771d5cdc08f2e278d479b60172fb9832b4c",permission_type:"none",run_attempt_count:0,run_success_count:0,share_with_workflow:!1,workflow_is_disruptive:!1},m=[{id:"abc123",name:"Mitre hosts"},{id:"def456",name:"RTR hosts"},{id:"ghi789",name:"Response hosts"}],$=[{name:"groups",buckets:[{label:"abc123",count:42},{label:"def456",count:23}]}],J=[{device_id:"xyz987",hostname:"Odysseus"},{device_id:"mno654",hostname:"Agamemnon"},{device_id:"pqr321",hostname:"Achilles"}],M=[{uuid:"uuid1",cid:"cid",uid:"f.bird@crowdstrike.com",first_name:"Falcon",last_name:"Bird",created_at:"2023-09-12T14:35:46Z"},{uuid:"uuid2",cid:"cid",uid:"p.bird@crowdstrike.com",first_name:"Peregrine",last_name:"Bird",created_at:"2023-09-12T14:35:46Z"},{uuid:"uuid3",cid:"cid",uid:"r.dino@crowdstrike.com",first_name:"Raptor",last_name:"Dino",created_at:"2023-09-12T14:35:46Z"}],B={user_id:"dummy",user_name:"dummy",version:0,id:"1",name:"First Job RR",description:"First Job RR description",notification_emails:null,notifications:["paul.rosset@crowdstrike.com"],draft:!0,tags:null,host_count:J.length,run_count:0,total_recurrences:0,action:{type:"installSoftware",install_file_path:"hello",command_switch:"world",file_name:E.name},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:null,hosts:J.map(i=>i.device_id),offline_queueing:!1},run_now:!1,next_run:"2023-09-02T08:25:17.179Z",last_run:"2023-09-02T08:25:17.179Z",created_at:"2023-09-02T08:25:17.179Z",updated_at:"2023-09-02T08:25:17.179Z",deleted_at:"2023-09-02T08:25:17.179Z"},Q={user_id:"dummy",user_name:"dummy",version:0,id:"2",name:"Second Job Test RR",description:"Second Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},U={user_id:"dummy",user_name:"dummy",version:0,id:"3",name:"Third Job Test RR",description:"Third Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},z={user_id:"dummy",user_name:"dummy",version:0,id:"4",name:"Fourth Job Test RR",description:"Fourth Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},K={user_id:"dummy",user_name:"dummy",version:0,id:"5",name:"Fifth Job Test RR",description:"Fifth Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},W={user_id:"dummy",user_name:"dummy",version:0,id:"6",name:"Sixth Job Test RR",description:"Sixth Job Test RR",notification_emails:null,notifications:null,draft:!1,tags:null,host_count:m.length,run_count:0,total_recurrences:0,action:{type:"removeFile",remove_file_name:"hello",remove_file_path:"world"},schedule:{start_date:"2023-08-31T08:25:17.179Z"},target:{host_groups:m.map(i=>i.id),hosts:null,offline_queueing:!0},run_now:!0,next_run:"2023-08-31T08:25:17.179Z",last_run:"2023-08-31T08:25:17.179Z",created_at:"2023-08-31T08:25:17.179Z",updated_at:"2023-08-31T08:25:17.179Z",deleted_at:"2023-08-31T08:25:17.179Z"},X={id:"1",job_id:"1",execution_id:"1",name:"First Job RR",run_date:"2023-08-11 09:35:29",duration:"00:12:21",status:"completed",hosts:["host1"],numHosts:1,receivedFiles:2,endDate:"2023-08-09 13:42:34"},Y={id:"1",job_id:"1",job_name:"CVE-2023-123456",modified_at:"2023-08-11 09:35:29",version:1,modified_by:"g.thegrey@crowdstrike.com",action:"Created JobRTR"};function x(i){return i.type==="api"}function O(i){return x(i)&&i.api==="faasGateway"}function ee(i){return x(i)&&i.api==="devices"}function te(i){return x(i)&&i.api==="userManagement"}function A(i){return x(i)&&i.api==="remoteResponse"}class ne{isMatch(t){return ee(t)&&(t.method==="postAggregatesDevicesGetV1"||t.method==="getEntitiesGroupsV1"||t.method==="postEntitiesDevicesV2"||t.method==="getQueriesDevicesV2")}async responder(t){let n={};if(t.method==="postAggregatesDevicesGetV1")n={errors:[],resources:$};else if(t.method==="getEntitiesGroupsV1")n={errors:[],resources:m};else if(t.method==="getQueriesDevicesV2"){const r=J.map(o=>o.device_id);n={errors:[],resources:r}}else t.method==="postEntitiesDevicesV2"&&(n={errors:[],resources:J});return Promise.resolve(n)}}class ie{isMatch(t){return te(t)&&(t.method==="postEntitiesUsersGetV1"||t.method==="getQueriesUsersV1")}async responder(t){let n={};return t.method==="postEntitiesUsersGetV1"?n={errors:[],resources:M}:t.method==="getQueriesUsersV1"&&(n={errors:[],resources:M.map(r=>r.uuid)}),Promise.resolve(n)}}const re={jobs:[],history:[],logs:[],rtrPutFiles:[]},Me={jobs:[B,Q,U,z,K,W],history:[X],logs:[Y],rtrPutFiles:[E,G,N]},D=e.object({type:e.literal("installSoftware"),install_file_path:e.string().optional(),command_switch:e.string().optional(),file_name:e.string()}),V=e.object({type:e.literal("removeFile"),remove_file_name:e.string(),remove_file_path:e.string()}),oe=e.object({user_id:e.string(),user_name:e.string(),version:e.number(),name:e.string(),description:e.string(),notifications:e.union([e.null(),e.array(e.string())]),tags:e.union([e.null(),e.array(e.string())]),action:e.union([D,V]),run_now:e.boolean(),schedule:e.union([e.object({start_date:e.string()}),e.null()]),target:e.object({host_groups:e.union([e.null(),e.array(e.string())]),hosts:e.union([e.null(),e.array(e.string())]),offline_queueing:e.boolean()})});e.object({user_id:e.string(),user_name:e.string(),version:e.number(),id:e.string(),name:e.string(),description:e.string(),notification_emails:e.union([e.null(),e.array(e.string())]).optional(),notifications:e.union([e.null(),e.array(e.string())]),draft:e.boolean(),tags:e.union([e.null(),e.array(e.string())]),host_count:e.number(),run_count:e.number(),total_recurrences:e.number(),action:e.union([D,V]),schedule:e.union([e.object({start_date:e.string()}),e.null()]),target:e.object({host_groups:e.union([e.null(),e.array(e.string())]),hosts:e.union([e.null(),e.array(e.string())]),offline_queueing:e.boolean()}),run_now:e.boolean(),next_run:e.string(),last_run:e.string(),created_at:e.string(),updated_at:e.string(),deleted_at:e.string()});const se=e.object({method:e.string(),payload:e.object({body:e.object({function_id:e.string().optional(),function_name:e.string().optional(),payload:e.object({path:e.string()})})})}),ae=e.object({function_id:e.string().optional(),function_name:e.string().optional(),function_version:e.number(),payload:e.object({params:e.object({query:e.object({draft:e.array(e.union([e.literal("true"),e.literal("false")]))}).optional()}).optional(),body:oe})}),ue=e.object({payload:e.object({body:e.object({payload:e.object({params:e.object({query:e.object({fieldName:e.union([e.literal("name"),e.literal("description"),e.literal("last_run_date"),e.literal("next_run_date"),e.literal("hosts"),e.literal("last_modified"),e.literal("draft")]).optional(),direction:e.union([e.literal("ASC"),e.literal("DESC")]).optional(),limit:e.union([e.array(e.literal("5")),e.array(e.literal("10")),e.array(e.literal("15")),e.array(e.literal("20"))]).optional(),offset:e.array(e.string()).optional(),prev:e.array(e.string()).optional(),next:e.array(e.string()).optional()}).optional()}).optional()})})})}),de=e.object({payload:e.object({body:e.object({payload:e.object({params:e.object({query:e.object({id:e.array(e.string())})})})})})}),Z=":";class P{constructor({db:t,appName:n}){u(this,"functionId","mock-faas-function");u(this,"functionName","mock-faas-function-name");u(this,"requestPath","/mock-path");u(this,"counter",0);u(this,"bus",{});u(this,"db");u(this,"appName");this.db=t,this.appName=n}isMatch(t){return O(t)&&(this.isPost(t)||this.isGet(t))}isPost(t){const n=se.safeParse(t);if(!n.success)return!1;const{method:r}=n.data,{function_id:o,function_name:s}=n.data.payload.body,{path:a}=n.data.payload.body.payload;return r==="postEntitiesExecutionV1"&&(o===this.functionId||s===this.functionName)&&a===this.requestPath}isGet(t){const{id:n}=t.payload.params;if(typeof n!="string")return!1;const[r,o,s,a]=n.split(Z);return t.method==="getEntitiesExecutionV1"&&(r===this.functionId||o===this.functionName)&&s===this.requestPath}prepareResponse(t){return{errors:[],resources:[]}}async responder(t){if(this.isPost(t)){const n=[this.functionId,this.functionName,this.requestPath,++this.counter].join(Z);return this.bus[n]=this.prepareResponse(t),Promise.resolve({resources:[{execution_id:n,function_id:this.functionId}]})}else if(this.isGet(t)){const{id:n}=t.payload.params;if(!n||typeof n!="string")throw"No id supplied";if(!this.bus[n])throw`No response for id: ${n}`;return Promise.resolve(this.bus[n])}}}class ce extends P{constructor(t){super(t),this.functionId=f.createJob.id,this.functionName=f.createJob.name,this.requestPath=f.createJob.path}prepareResponse(t){var o,s;if(!("body"in t.payload))throw`CreateJobHandler received bad message: ${t.toString()}`;const r=ae.safeParse(t.payload.body);if(r.success){const a=this.db.jobs.findIndex(p=>p.name===r.data.payload.body.name);if(a>-1&&this.db.jobs[a].draft===!1)return{resources:[{function_id:this.functionId,function_name:this.functionName,function_version:1,payload:{body:null,errors:[{field:"jobName",message:`Job name "${r.data.payload.body.name}" already exists"`,code:102}],status_code:400}}]};const[l]=((s=(o=r.data.payload.params)==null?void 0:o.query)==null?void 0:s.draft)??["false"],{version:d,..._}=r.data.payload.body,y={id:a>-1?this.db.jobs[a].id:(Math.random()+1).toString(36).substring(7),version:d+1,draft:l==="true",total_recurrences:0,run_count:0,host_count:0,next_run:"2023-12-01T12:00",last_run:"",created_at:"2023-12-01T12:00",updated_at:"2023-12-01T12:00",deleted_at:"",notification_emails:_.notifications,..._};return a===-1?this.db.jobs.unshift(y):a>-1&&this.db.jobs[a].draft===!0&&(this.db.jobs[a]=y),{errors:[],resources:[{function_id:this.functionId,function_name:this.functionName,function_version:1,payload:{body:{resource:"a_random_uid"},errors:[],status_code:200}}]}}else return{resources:[{function_id:this.functionId,function_name:this.functionName,function_version:1,payload:{body:null,errors:r.error.issues.map(a=>({message:a.message})),status_code:400}}]}}}e.object({job_name:e.string(),modified_at:e.string(),version:e.number(),modified_by:e.string(),action:e.string(),id:e.string(),job_id:e.string()});const le=e.object({payload:e.object({body:e.object({payload:e.object({params:e.object({query:e.object({fieldName:e.union([e.literal("name"),e.literal("date_modified"),e.literal("version"),e.literal("modified_by"),e.literal("action_taken")]).optional(),direction:e.union([e.literal("ASC"),e.literal("DESC")]).optional(),limit:e.union([e.array(e.literal("5")),e.array(e.literal("10")),e.array(e.literal("15")),e.array(e.literal("20"))]).optional(),offset:e.array(e.string()).optional(),prev:e.array(e.string()).optional(),next:e.array(e.string()).optional(),page:e.number().optional(),id:e.array(e.string()).optional(),filter:e.array(e.string()).optional()}).optional()}).optional()})})})}),q=10;function pe(i,t,n){const r=Math.ceil((n+1)/t);return n===-1?{paginatedJobs:i,page:r}:{paginatedJobs:i.slice(n,n+(t+1)),page:r}}function fe(i,t,n,r,o){var p,h,b;let s=i.findIndex(c=>c.id===n);o!==""?s=i.findIndex(c=>c.id===o):r!==""&&(s=i.findIndex(c=>c.id===r));const{paginatedJobs:a,page:l}=pe(i,t,s),d=(p=i[s-t])!=null&&p.id?`${(h=i[s-t])==null?void 0:h.id}:${l-1}`:"",_=i.slice(-1),g=a.length===t+1?`${(b=_[0])==null?void 0:b.id}:${l}`:"";return{currentPage:t?a.slice(0,t):a,prevCursor:d,nextCursor:g}}class _e extends P{constructor(t){super(t),this.functionId=f.getAuditLog.id,this.functionName=f.getAuditLog.name,this.requestPath=f.getAuditLog.path}prepareResponse(t){var R,T,w,j;const{logs:n}=this.db,o=((R=le.parse(t).payload.body.payload.params)==null?void 0:R.query)??{},{offset:s=null,limit:a=[String(q)],prev:l=null,next:d=null}=o,_=(s==null?void 0:s[0])??"",g=((T=l==null?void 0:l[0].split(":"))==null?void 0:T[0])??"",y=((w=d==null?void 0:d[0].split(":"))==null?void 0:w[0])??"",p=parseInt(a[0])??q;let h=n;if(o&&o.filter&&o.filter.length>0){const[Je,S]=o.filter[0].split(":");h=n.filter(L=>S.includes(L.job_id))}const{prevCursor:b,nextCursor:c,currentPage:v}=fe(h,p,_,g,y);return{errors:[],resources:[{function_id:this.functionId,function_version:1,payload:{body:{resources:h,meta:{total:n.length,limit:p,offset:((j=v[0])==null?void 0:j.id)||"",count:v.length,prev:b,next:c}}}}]}}}class he{constructor({db:t}){u(this,"db");this.db=t}isMatch(t){return A(t)&&t.method==="getEntitiesPutFilesV2"}responder(t){return Promise.resolve({errors:void 0,resources:this.prepareResponse(t)})}prepareResponse(t){const{ids:n}=t.payload.params;return!Array.isArray(n)||n.length===0?[]:this.db.rtrPutFiles.filter(r=>n.includes(r.id))}}class be extends P{constructor(t){super(t),this.functionId=f.getJobDetails.id,this.functionName=f.getJobDetails.name,this.requestPath=f.getJobDetails.path}prepareResponse(t){const{jobs:n}=this.db,o=de.parse(t).payload.body.payload.params.query??{},s=n.find(a=>o.id.includes(a.id));return{errors:[],resources:[{function_id:this.functionId,function_version:1,payload:{body:{resource:s}}}]}}}function me(i,t,n){const r=Math.ceil((n+1)/t);return n===-1?{paginatedJobs:i,page:r}:{paginatedJobs:i.slice(n,n+(t+1)),page:r}}function ge(i,t,n,r,o){var p,h,b;let s=i.findIndex(c=>c.id===n);o!==""?s=i.findIndex(c=>c.id===o):r!==""&&(s=i.findIndex(c=>c.id===r));const{paginatedJobs:a,page:l}=me(i,t,s),d=(p=i[s-t])!=null&&p.id?`${(h=i[s-t])==null?void 0:h.id}:${l-1}`:"",_=i.slice(-1),g=a.length===t+1?`${(b=_[0])==null?void 0:b.id}:${l}`:"";return{currentPage:t?a.slice(0,t):a,prevCursor:d,nextCursor:g}}class ye extends P{constructor(t){super(t),this.functionId=f.getJobs.id,this.functionName=f.getJobs.name,this.requestPath=f.getJobs.path}prepareResponse(t){var R,T,w,j;const{jobs:n}=this.db,o=((R=ue.parse(t).payload.body.payload.params)==null?void 0:R.query)??{},{offset:s=null,limit:a=[String(F)],prev:l=null,next:d=null}=o,_=(s==null?void 0:s[0])??"",g=((T=l==null?void 0:l[0].split(":"))==null?void 0:T[0])??"",y=((w=d==null?void 0:d[0].split(":"))==null?void 0:w[0])??"",p=parseInt(a[0])??F,h=n,{prevCursor:b,nextCursor:c,currentPage:v}=ge(h,p,_,g,y);return{errors:[],resources:[{function_id:this.functionId,function_version:1,payload:{body:{resources:v,meta:{total:n.length,limit:p,offset:((j=v[0])==null?void 0:j.id)||"",count:v.length,prev:b,next:c}}}}]}}}class ve{constructor({db:t}){u(this,"db");this.db=t}isMatch(t){return A(t)&&t.method==="getQueriesPutFilesV1"}responder(t){return Promise.resolve({errors:void 0,resources:this.prepareResponse(t)})}prepareResponse(t){const{filter:n}=t.payload.params;if(n&&typeof n=="string"){const[r,o]=n.split(":"),s=o.replace(/[']/g,"");return this.db.rtrPutFiles.filter(a=>a.name.includes(s)).map(a=>a.id)}return this.db.rtrPutFiles.map(r=>r.id)}}e.object({id:e.string(),job_id:e.string(),execution_id:e.string(),name:e.string(),duration:e.string(),hosts:e.array(e.string()),numHosts:e.number(),receivedFiles:e.number(),run_date:e.string(),endDate:e.string(),status:e.string()});const Re=e.object({payload:e.object({body:e.object({payload:e.object({params:e.object({query:e.object({fieldName:e.union([e.literal("name"),e.literal("run_date"),e.literal("status"),e.literal("duration"),e.literal("hosts")]).optional(),direction:e.union([e.literal("ASC"),e.literal("DESC")]).optional(),limit:e.union([e.array(e.literal("5")),e.array(e.literal("10")),e.array(e.literal("15")),e.array(e.literal("20"))]).optional(),offset:e.array(e.string()).optional(),prev:e.array(e.string()).optional(),next:e.array(e.string()).optional(),id:e.array(e.string()).optional(),filter:e.array(e.string()).optional(),exact_name:e.array(e.string()).optional()}).optional()}).optional()})})})}),I=10;function Te(i,t,n){var o;const r=i.findIndex(s=>s.id===n);return((o=i[r-t])==null?void 0:o.job_id)||""}function we(i,t,n){const r=i.findIndex(o=>o.id===n);return r===-1?i:i.slice(r,r+(t+1))}function je(i,t,n){var d;const r=we(i,t,n),o=Te(i,t,n),s=i.slice(-1),a=r.length===t+1?(d=s[0])==null?void 0:d.id:"";return{currentPage:t?r.slice(0,t):r,prevCursor:o,nextCursor:a}}class Pe extends P{constructor(t){super(t),this.functionId=f.getRunHistory.id,this.functionName=f.getRunHistory.name,this.requestPath=f.getRunHistory.path}prepareResponse(t){var h;const{history:n}=this.db,o=((h=Re.parse(t).payload.body.payload.params)==null?void 0:h.query)??{},{offset:s=null,limit:a=[String(I)]}=o,l=(s==null?void 0:s[0])??"",d=parseInt(a[0])??I;let _=n;if(o&&o.filter&&o.filter.length>0){const b=o.filter[0].split(":")[0],c=o.filter[0].split(":")[1];_=n.filter(v=>{var R,T;if(b==="job_name"&&(((R=o.exact_name)==null?void 0:R.length)??0>0))return((T=o.exact_name)==null?void 0:T[0])==="true"?c===v.name:c.includes(v.name);if(b==="job_id")return v.job_id===c})}const{prevCursor:g,nextCursor:y,currentPage:p}=je(_,d,l);return{errors:[],resources:[{function_id:this.functionId,function_version:1,payload:{body:{resources:p,meta:{total:_.length,limit:d,count:p.length,prev:g,next:y}}}}]}}}class Ze extends H{constructor({db:n,appName:r}={db:re,appName:"rapid-response"}){super();u(this,"createJob");u(this,"getJobs");u(this,"getJobDetails");u(this,"getAuditLog");u(this,"getRunHistory");u(this,"getQueriesPutFilesV1");u(this,"getEntitiesPutFilesV2");u(this,"devices");u(this,"userManagement");u(this,"db");this.db=n,this.createJob=new ce({db:this.db,appName:r}),this.getJobs=new ye({db:this.db,appName:r}),this.getJobDetails=new be({db:this.db,appName:r}),this.getAuditLog=new _e({db:this.db,appName:r}),this.getRunHistory=new Pe({db:this.db,appName:r}),this.getQueriesPutFilesV1=new ve({db:this.db}),this.getEntitiesPutFilesV2=new he({db:this.db}),this.devices=new ne,this.userManagement=new ie}async postMessage(n){let r;if(this.devices.isMatch(n)?r=await this.devices.responder(n):this.userManagement.isMatch(n)?r=await this.userManagement.responder(n):this.getJobs.isMatch(n)?r=await this.getJobs.responder(n):this.createJob.isMatch(n)?r=await this.createJob.responder(n):this.getJobDetails.isMatch(n)?r=await this.getJobDetails.responder(n):this.getAuditLog.isMatch(n)?r=await this.getAuditLog.responder(n):this.getRunHistory.isMatch(n)?r=await this.getRunHistory.responder(n):this.getQueriesPutFilesV1.isMatch(n)?r=await this.getQueriesPutFilesV1.responder(n):this.getEntitiesPutFilesV2.isMatch(n)?r=await this.getEntitiesPutFilesV2.responder(n):r=await super.postMessage(n),!r)throw new Error("Woops!");return console.log("MockBridge#postMessage: ",{message:n,value:r}),r}}export{Ze as MockBridge,re as emptyScenario,Me as populatedScenario};
